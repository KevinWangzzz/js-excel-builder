"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ownKeys(r,e){var t,o=Object.keys(r);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(r),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),o.push.apply(o,t)),o}function _objectSpread2(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}var XLSX=require("xlsx"),bufferFrom=require("buffer-from"),_require=require("./sheetBuilder"),SheetBuilder=_require.SheetBuilder,WorkbookBuilder=function(){function e(){_classCallCheck(this,e),this.workBook={SheetNames:[],Sheets:{}},this.defaultOptions={bookType:"xlsx",bookSST:!1,type:"binary"}}return _createClass(e,[{key:"build",value:function(e){var o=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=new SheetBuilder;e.map(function(e){var r=e.sheetName||"Excel",t=e.sheetData||[],e=e.sheetOptions;o.workBook.SheetNames.push(r),o.workBook.Sheets[r]=n.build(t,e)});r=XLSX.write(this.workBook,_objectSpread2(_objectSpread2({},this.defaultOptions),r));return r instanceof Buffer?r:bufferFrom(r,"binary")}}]),e}();module.exports={WorkbookBuilder:WorkbookBuilder};
